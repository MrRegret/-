<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…ƒæ°”å£çº¸ ForwardWidget æ¼”ç¤º</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(45deg, #667eea, #764ba2, #f093fb, #f5576c);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .demo-header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .demo-header h1 {
            font-size: 36px;
            margin: 0;
            margin-bottom: 10px;
        }

        .demo-header p {
            font-size: 18px;
            opacity: 0.9;
            margin: 0;
        }

        .demo-controls {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .demo-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            backdrop-filter: blur(10px);
        }

        .demo-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .demo-info {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            color: white;
        }

        .demo-info h3 {
            margin-top: 0;
            color: #FFE894;
        }

        .demo-info ul {
            list-style-type: none;
            padding-left: 0;
        }

        .demo-info li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .demo-info li:before {
            content: "âœ¨";
            position: absolute;
            left: 0;
        }

        .status-display {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #E0E0E0;
            max-height: 200px;
            overflow-y: auto;
        }

        #wallpaper-widget-container {
            margin: 20px 0;
        }

        .loading-placeholder {
            text-align: center;
            padding: 60px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 18px;
        }

        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .demo-header h1 {
                font-size: 28px;
            }
            
            .demo-header p {
                font-size: 16px;
            }
            
            .demo-controls {
                padding: 15px;
            }
            
            .demo-btn {
                display: block;
                width: 100%;
                margin: 8px 0;
            }
        }
    </style>
</head>
<body>
    <div class="demo-header">
        <h1>ğŸ¨ å…ƒæ°”å£çº¸ ForwardWidget</h1>
        <p>é«˜è´¨é‡åŠ¨æ€å’Œé™æ€å£çº¸è·å–å·¥å…·æ¼”ç¤º</p>
    </div>

    <div class="demo-controls">
        <h3 style="color: white; margin-top: 0;">ğŸ› ï¸ æ¼”ç¤ºæ§åˆ¶</h3>
        <button class="demo-btn" onclick="initWidget()">ğŸš€ åˆå§‹åŒ–ç»„ä»¶</button>
        <button class="demo-btn" onclick="getRandomWallpapers()">ğŸ² è·å–éšæœºå£çº¸</button>
        <button class="demo-btn" onclick="searchAnime()">ğŸ” æœç´¢åŠ¨æ¼«å£çº¸</button>
        <button class="demo-btn" onclick="getStatus()">ğŸ“Š æŸ¥çœ‹çŠ¶æ€</button>
        <button class="demo-btn" onclick="clearCache()">ğŸ—‘ï¸ æ¸…ç†ç¼“å­˜</button>
    </div>

    <div id="wallpaper-widget-container">
        <div class="loading-placeholder">
            <div class="loading-spinner"></div>
            <div>ç‚¹å‡»"åˆå§‹åŒ–ç»„ä»¶"å¼€å§‹ä½“éªŒ</div>
        </div>
    </div>

    <div class="demo-info">
        <h3>ğŸŒŸ åŠŸèƒ½ç‰¹æ€§</h3>
        <ul>
            <li>æ”¯æŒéšæœºè·å–é«˜è´¨é‡å£çº¸</li>
            <li>8å¤§åˆ†ç±»ï¼š4Kã€é£æ™¯ã€åŠ¨æ¼«ã€ç¾å¥³ã€åŠ¨ç‰©ã€æ¸¸æˆã€å°æ¸…æ–°ã€å…¶ä»–</li>
            <li>æ™ºèƒ½å…³é”®è¯æœç´¢åŠŸèƒ½</li>
            <li>30åˆ†é’Ÿæ™ºèƒ½ç¼“å­˜æœºåˆ¶</li>
            <li>ç°ä»£åŒ–UIè®¾è®¡ï¼Œå“åº”å¼å¸ƒå±€</li>
            <li>ä¸€é”®ä¸‹è½½å’Œé¢„è§ˆåŠŸèƒ½</li>
            <li>å®Œå…¨å…¼å®¹ForwardWidgetæ ‡å‡†</li>
        </ul>

        <h3>ğŸ“± ä½¿ç”¨è¯´æ˜</h3>
        <ul>
            <li>ç‚¹å‡»"éšæœºå£çº¸"è·å–ç²¾é€‰æ¨è</li>
            <li>é€‰æ‹©"åˆ†ç±»æµè§ˆ"æŒ‰ä¸»é¢˜ç­›é€‰</li>
            <li>ä½¿ç”¨"æœç´¢å£çº¸"è¾“å…¥å…³é”®è¯</li>
            <li>ç‚¹å‡»å£çº¸çš„"ä¸‹è½½"æŒ‰é’®ä¿å­˜åˆ°æœ¬åœ°</li>
            <li>ç‚¹å‡»"é¢„è§ˆ"æŒ‰é’®æŸ¥çœ‹é«˜æ¸…å¤§å›¾</li>
            <li>ç‚¹å‡»"è¯¦æƒ…"è®¿é—®åŸå§‹é¡µé¢</li>
        </ul>

        <div id="status-info" class="status-display">
            çŠ¶æ€ä¿¡æ¯å°†åœ¨è¿™é‡Œæ˜¾ç¤º...
        </div>
    </div>

    <div class="footer">
        <p>ğŸ¨ å…ƒæ°”å£çº¸ ForwardWidget v1.0.0</p>
        <p>åŸºäº <a href="https://mbizhi.cheetahfun.com" style="color: #FFE894;">mbizhi.cheetahfun.com</a> å¼€å‘</p>
    </div>

    <!-- å¼•å…¥ç»„ä»¶è„šæœ¬ -->
    <script src="yuanqi-wallpaper-widget.js"></script>

    <script>
        let widgetInitialized = false;
        let statusElement = document.getElementById('status-info');

        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus(message) {
            const timestamp = new Date().toLocaleTimeString();
            statusElement.innerHTML += `[${timestamp}] ${message}\n`;
            statusElement.scrollTop = statusElement.scrollHeight;
        }

        // åˆå§‹åŒ–ç»„ä»¶
        async function initWidget() {
            if (widgetInitialized) {
                updateStatus("âœ… ç»„ä»¶å·²ç»åˆå§‹åŒ–è¿‡äº†");
                return;
            }

            updateStatus("ğŸš€ å¼€å§‹åˆå§‹åŒ–å…ƒæ°”å£çº¸ç»„ä»¶...");
            
            try {
                // å¦‚æœç»„ä»¶è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ‰‹åŠ¨åˆå§‹åŒ–
                if (!window.wallpaperWidget) {
                    await initializeWallpaperWidget();
                }
                
                widgetInitialized = true;
                updateStatus("âœ… ç»„ä»¶åˆå§‹åŒ–æˆåŠŸï¼");
                updateStatus("ğŸ“Š å¯ä»¥å¼€å§‹ä½¿ç”¨å„ç§åŠŸèƒ½äº†");
                
            } catch (error) {
                updateStatus(`âŒ åˆå§‹åŒ–å¤±è´¥: ${error.message}`);
                console.error('åˆå§‹åŒ–å¤±è´¥:', error);
            }
        }

        // è·å–éšæœºå£çº¸
        async function getRandomWallpapers() {
            if (!widgetInitialized) {
                updateStatus("âš ï¸ è¯·å…ˆåˆå§‹åŒ–ç»„ä»¶");
                return;
            }

            updateStatus("ğŸ² æ­£åœ¨è·å–éšæœºå£çº¸...");
            
            try {
                await wallpaperWidget.switchPage('random');
                await wallpaperWidget.loadRandomWallpapers();
                updateStatus("âœ… éšæœºå£çº¸åŠ è½½å®Œæˆ");
                
            } catch (error) {
                updateStatus(`âŒ è·å–éšæœºå£çº¸å¤±è´¥: ${error.message}`);
            }
        }

        // æœç´¢åŠ¨æ¼«å£çº¸
        async function searchAnime() {
            if (!widgetInitialized) {
                updateStatus("âš ï¸ è¯·å…ˆåˆå§‹åŒ–ç»„ä»¶");
                return;
            }

            updateStatus("ğŸ” æ­£åœ¨æœç´¢åŠ¨æ¼«å£çº¸...");
            
            try {
                await wallpaperWidget.switchPage('search');
                await wallpaperWidget.searchWallpapers('åŠ¨æ¼«');
                updateStatus("âœ… åŠ¨æ¼«å£çº¸æœç´¢å®Œæˆ");
                
            } catch (error) {
                updateStatus(`âŒ æœç´¢å¤±è´¥: ${error.message}`);
            }
        }

        // è·å–çŠ¶æ€ä¿¡æ¯
        function getStatus() {
            if (!widgetInitialized) {
                updateStatus("âš ï¸ è¯·å…ˆåˆå§‹åŒ–ç»„ä»¶");
                return;
            }

            try {
                const status = wallpaperWidget.getStatus();
                const stats = wallpaperWidget.client.getStats();
                
                updateStatus("ğŸ“Š ç»„ä»¶çŠ¶æ€ä¿¡æ¯:");
                updateStatus(`   å½“å‰é¡µé¢: ${status.currentPage}`);
                updateStatus(`   å½“å‰åˆ†ç±»: ${status.currentCategory || 'æ— '}`);
                updateStatus(`   æœç´¢å…³é”®è¯: ${status.currentKeyword || 'æ— '}`);
                updateStatus(`   å£çº¸æ•°é‡: ${status.wallpaperCount}`);
                updateStatus(`   è¯·æ±‚æ¬¡æ•°: ${stats.requestCount}`);
                updateStatus(`   ç¼“å­˜é¡¹ç›®: ${stats.cacheSize}`);
                updateStatus(`   æ”¯æŒåˆ†ç±»: ${stats.categories} ä¸ª`);
                
            } catch (error) {
                updateStatus(`âŒ è·å–çŠ¶æ€å¤±è´¥: ${error.message}`);
            }
        }

        // æ¸…ç†ç¼“å­˜
        function clearCache() {
            if (!widgetInitialized) {
                updateStatus("âš ï¸ è¯·å…ˆåˆå§‹åŒ–ç»„ä»¶");
                return;
            }

            try {
                const beforeSize = wallpaperWidget.client.cache.size;
                wallpaperWidget.client.cache.clear();
                updateStatus(`ğŸ—‘ï¸ å·²æ¸…ç†ç¼“å­˜ï¼Œåˆ é™¤äº† ${beforeSize} ä¸ªç¼“å­˜é¡¹ç›®`);
                
            } catch (error) {
                updateStatus(`âŒ æ¸…ç†ç¼“å­˜å¤±è´¥: ${error.message}`);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–æç¤º
        document.addEventListener('DOMContentLoaded', () => {
            updateStatus("ğŸ¨ å…ƒæ°”å£çº¸ ForwardWidget æ¼”ç¤ºé¡µé¢å·²åŠ è½½");
            updateStatus("ğŸ’¡ ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹ä½“éªŒå„ç§åŠŸèƒ½");
            updateStatus("ğŸ“± æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡è®¿é—®");
            
            // è‡ªåŠ¨åˆå§‹åŒ–ç»„ä»¶ï¼ˆå¯é€‰ï¼‰
            setTimeout(() => {
                updateStatus("â° 3ç§’åè‡ªåŠ¨åˆå§‹åŒ–ç»„ä»¶...");
                setTimeout(initWidget, 3000);
            }, 1000);
        });

        // ç›‘å¬ç»„ä»¶äº‹ä»¶ï¼ˆå¦‚æœç»„ä»¶æ”¯æŒäº‹ä»¶ç³»ç»Ÿï¼‰
        document.addEventListener('wallpaperLoaded', (event) => {
            updateStatus(`ğŸ“¸ å£çº¸åŠ è½½äº‹ä»¶: ${event.detail.count} å¼ å£çº¸`);
        });

        document.addEventListener('wallpaperError', (event) => {
            updateStatus(`âŒ å£çº¸é”™è¯¯äº‹ä»¶: ${event.detail.message}`);
        });

        // æ€§èƒ½ç›‘æ§
        let performanceStart = Date.now();
        window.addEventListener('load', () => {
            const loadTime = Date.now() - performanceStart;
            updateStatus(`âš¡ é¡µé¢åŠ è½½è€—æ—¶: ${loadTime}ms`);
        });

        // æ·»åŠ é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (event) => {
            if (event.ctrlKey || event.metaKey) {
                switch (event.key) {
                    case '1':
                        event.preventDefault();
                        initWidget();
                        break;
                    case '2':
                        event.preventDefault();
                        getRandomWallpapers();
                        break;
                    case '3':
                        event.preventDefault();
                        searchAnime();
                        break;
                    case 's':
                        event.preventDefault();
                        getStatus();
                        break;
                }
            }
        });

        // æ˜¾ç¤ºå¿«æ·é”®æç¤º
        setTimeout(() => {
            updateStatus("âŒ¨ï¸ å¿«æ·é”®æç¤º:");
            updateStatus("   Ctrl+1: åˆå§‹åŒ–ç»„ä»¶");
            updateStatus("   Ctrl+2: è·å–éšæœºå£çº¸");
            updateStatus("   Ctrl+3: æœç´¢åŠ¨æ¼«å£çº¸");
            updateStatus("   Ctrl+S: æŸ¥çœ‹çŠ¶æ€");
        }, 2000);
    </script>
</body>
</html>